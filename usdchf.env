# USD/CHF Optimized Configuration
# Phase 1: MA period optimization (25 combinations) → Best: 50/300 with $2,522
# Phase 2: SL/TP optimization (36 combinations) → Best: SL=1.4, TP=4.0 with $3,153
# Phase 3: Hour exclusion testing pending (time filter had weekday mode issue)
# Last updated: November 14, 2025

# =============================================================================
# DATA INGESTION
# =============================================================================
DATA_SYMBOLS=USD/CHF
DATA_START_DATE=2024-01-01
DATA_END_DATE=2025-10-30

# =============================================================================
# IBKR CONNECTION
# =============================================================================
IB_HOST=127.0.0.1
IB_PORT=7497
IB_CLIENT_ID=17
IB_ACCOUNT_ID=DU1558484
IB_MARKET_DATA_TYPE=REALTIME
IB_MAX_CONNECTION_ATTEMPTS=5

# =============================================================================
# BACKTESTING PARAMETERS
# =============================================================================
BACKTEST_SYMBOL=USD/CHF
BACKTEST_START_DATE=2024-01-01
BACKTEST_END_DATE=2025-10-30
BACKTEST_VENUE=IDEALPRO
BACKTEST_BAR_SPEC=15-MINUTE-MID-EXTERNAL

# Moving Average Periods (OPTIMIZED - Phase 1 winner)
BACKTEST_FAST_PERIOD=50
BACKTEST_SLOW_PERIOD=300

# Position Sizing
BACKTEST_TRADE_SIZE=100000
BACKTEST_STARTING_CAPITAL=100000.0
CATALOG_PATH=data/historical
OUTPUT_DIR=logs/backtest_results
ENFORCE_POSITION_LIMIT=true
ALLOW_POSITION_REVERSAL=false

# =============================================================================
# ADAPTIVE STOPS (OPTIMIZED - Phase 2 winner)
# =============================================================================
# SL=1.4, TP=4.0 delivered best results: $3,153 PnL, 29.5% win rate, 373 trades

BACKTEST_ADAPTIVE_STOP_MODE=atr
BACKTEST_ADAPTIVE_ATR_PERIOD=14

# Optimized SL/TP from Phase 2
BACKTEST_SL_ATR_MULT=1.4
BACKTEST_TP_ATR_MULT=4.0

# Trailing stops - disabled for now
BACKTEST_TRAIL_ACTIVATION_ATR_MULT=1.0
BACKTEST_TRAIL_DISTANCE_ATR_MULT=0.8

# Percentile mode settings (for later optimization)
BACKTEST_VOLATILITY_WINDOW=200
BACKTEST_VOLATILITY_SENSITIVITY=0.6
BACKTEST_MIN_STOP_DISTANCE_PIPS=5.0

# Fixed stop fallback
BACKTEST_STOP_LOSS_PIPS=30
BACKTEST_TAKE_PROFIT_PIPS=75
BACKTEST_TRAILING_STOP_ACTIVATION_PIPS=30
BACKTEST_TRAILING_STOP_DISTANCE_PIPS=25

# =============================================================================
# STRATEGY FILTERS - BASELINE
# =============================================================================
STRATEGY_CROSSOVER_THRESHOLD_PIPS=0.15

# Trend Filter - Starting disabled
STRATEGY_TREND_FILTER_ENABLED=false
STRATEGY_TREND_BAR_SPEC=5-MINUTE-MID-EXTERNAL
STRATEGY_TREND_EMA_PERIOD=200
STRATEGY_TREND_EMA_THRESHOLD_PIPS=2.0

# RSI Filter - Starting disabled
STRATEGY_RSI_ENABLED=false
STRATEGY_RSI_PERIOD=14
STRATEGY_RSI_OVERBOUGHT=70
STRATEGY_RSI_OVERSOLD=30
STRATEGY_RSI_DIVERGENCE_LOOKBACK=5

# Volume Filter - Starting disabled
STRATEGY_VOLUME_ENABLED=false
STRATEGY_VOLUME_AVG_PERIOD=20
STRATEGY_VOLUME_MIN_MULTIPLIER=1.2

# ATR Filter - Starting disabled
STRATEGY_ATR_ENABLED=false
STRATEGY_ATR_PERIOD=14
STRATEGY_ATR_MIN_STRENGTH=0.0004

# DMI Filter - Starting enabled (same as EUR/USD)
STRATEGY_DMI_ENABLED=true
STRATEGY_DMI_PERIOD=14
STRATEGY_DMI_ADX_THRESHOLD=25.0
STRATEGY_DMI_DI_SEPARATION=5.0

# Multi-Timeframe Analysis - Starting disabled
STRATEGY_MTF_ENABLED=false
STRATEGY_MTF_TREND_TIMEFRAME=4-HOUR-MID-EXTERNAL
STRATEGY_MTF_TREND_EMA_PERIOD=50
STRATEGY_MTF_STRUCTURE_TIMEFRAME=1-HOUR-MID-EXTERNAL
STRATEGY_MTF_STRUCTURE_LOOKBACK=20
STRATEGY_MTF_STRUCTURE_THRESHOLD_PIPS=5.0

# =============================================================================
# TIME FILTERS - OPTIMIZED (Phase 3 winner)
# =============================================================================
# Exclude 10 worst performing hours: 1,2,3,13,17,18,19,20,21,22 UTC
# These hours showed consistently negative PnL in historical analysis
# Result: $5,288 PnL (+68% vs no filter), 31.3% win rate, 15.33 expectancy
BACKTEST_TIME_FILTER_ENABLED=true
BACKTEST_EXCLUDED_HOURS=1,2,3,13,17,18,19,20,21,22
BACKTEST_EXCLUDED_WEEKDAY_HOURS=

# =============================================================================
# MARKET REGIME DETECTION
# =============================================================================
REGIME_DETECTION_ENABLED=false
REGIME_DETECTION_TIMEFRAME=1-HOUR-MID-EXTERNAL
REGIME_VOLATILITY_PERIOD=20
REGIME_VOLATILITY_THRESHOLD=1.5
REGIME_TREND_PERIOD=50
REGIME_TREND_THRESHOLD=0.0001
REGIME_ADJUST_TP_SL=true
REGIME_TRENDING_TP_MULTIPLIER=1.5
REGIME_RANGING_SL_MULTIPLIER=0.7

# =============================================================================
# LIVE TRADING (NOT READY YET - NEEDS OPTIMIZATION FIRST)
# =============================================================================
LIVE_SYMBOL=USD/CHF
LIVE_VENUE=IDEALPRO
LIVE_BAR_SPEC=15-MINUTE-MID-EXTERNAL
LIVE_FAST_PERIOD=30
LIVE_SLOW_PERIOD=200
LIVE_TRADE_SIZE=100000
LIVE_STOP_LOSS_PIPS=30
LIVE_TAKE_PROFIT_PIPS=75
LIVE_TRAILING_STOP_ACTIVATION_PIPS=30
LIVE_TRAILING_STOP_DISTANCE_PIPS=25
LIVE_MAX_OPEN_POSITIONS=1
LIVE_POSITION_MANAGEMENT_ENABLED=true
LIVE_ADAPTIVE_STOP_MODE=atr
LIVE_SL_ATR_MULT=1.5
LIVE_TP_ATR_MULT=3.0
LIVE_TRAIL_ACTIVATION_ATR_MULT=1.0
LIVE_TRAIL_DISTANCE_ATR_MULT=0.8
LIVE_VOLATILITY_WINDOW=200
LIVE_VOLATILITY_SENSITIVITY=0.6
LIVE_MIN_STOP_DISTANCE_PIPS=5.0
